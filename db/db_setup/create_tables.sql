--- CREATING TABLES

-- Countries etc with only Name column
CREATE TABLE Countries (
  Id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  Name VARCHAR(64) NOT NULL UNIQUE
);

CREATE TABLE Languages (
  Id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  Name VARCHAR(64) NOT NULL UNIQUE
);

CREATE TABLE Genres (
  Id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  Name VARCHAR(64) NOT NULL UNIQUE
);

CREATE TABLE Publishers (
  Id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  Name VARCHAR(64) NOT NULL UNIQUE
);

CREATE TABLE BookTypes (
  Id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  Name VARCHAR(32) NOT NULL UNIQUE
);

-- Authors
CREATE TABLE Authors (
  Id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  Name VARCHAR(64) NOT NULL UNIQUE,
  Surname VARCHAR(64),
  DateOfBirth DATE,
  CountryId INTEGER,
  AboutAuthor BLOB SUB_TYPE TEXT,
  FOREIGN KEY (CountryId) REFERENCES Countries(Id)
);

-- Books
CREATE TABLE Books (
  Id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  AuthorId INTEGER,
  Name VARCHAR(64) NOT NULL UNIQUE,
  GenreId INTEGER,
  Description BLOB SUB_TYPE TEXT,
  Rating BLOB SUB_TYPE TEXT,
  LanguageId INTEGER,
  PublishingHouseId INTEGER,
  Isbn VARCHAR(13),
  Ean VARCHAR(13),
  Length SMALLINT,
  Photo BLOB SUB_TYPE BINARY,
  FOREIGN KEY (authorId) REFERENCES Authors(id),
  FOREIGN KEY (genreId) REFERENCES Genres(id),
  FOREIGN KEY (languageId) REFERENCES Languages(id),
  FOREIGN KEY (publishingHouseId) REFERENCES Publishers(id)
);

-- table to connect Books and Types becouse of BCNF
CREATE TABLE BOOK_TO_TYPE (
  Id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	BookId INTEGER,
	TypeId INTEGER,
	UNIQUE(BookId,TypeId)
);

-- inserts for BookTypes
INSERT INTO BookTypes(name) VALUES('tvrdá');
INSERT INTO BookTypes(name) VALUES('měkka');
INSERT INTO BookTypes(name) VALUES('leporelo');
INSERT INTO BookTypes(name) VALUES('elektronická');
INSERT INTO BookTypes(name) VALUES('audio');



COMMIT;
